<!doctype html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tao Fish - éš¨æ©ŸæŠ½é­š</title>
    <link rel="stylesheet" href="../css/main.css" />
    <style>
      :root {
        --render-scale: 0.45;
      }
      .scene {
        visibility: hidden;
      }
    </style>
  </head>
  <body class="layout-center">
    <button class="btn btn-primary btn-group" id="drawBtn">
      ğŸ£ æ‹‹ç«¿æŠ½é­šï¼
    </button>

    <div class="scene" id="card-scene">
      <div class="card-wrapper">
        <div class="card" id="card-element">
          <div class="card-face card-front" id="card-content"></div>
        </div>
      </div>
    </div>

    <script type="module">
      import { loadFishCards } from "../js/data-loader.js";
      import { renderFishCardContent } from "../js/card-renderer.js";
      import {
        getRandomItem,
        triggerAnimation,
        showError,
      } from "../js/utils.js";

      let deck = [];

      async function init() {
        try {
          deck = await loadFishCards();
          document
            .getElementById("drawBtn")
            .addEventListener("click", drawCard);
        } catch (err) {
          showError("ç„¡æ³•è¼‰å…¥é­šå¡è³‡æ–™");
        }
      }

      function drawCard() {
        if (deck.length === 0) return;

        const fish = getRandomItem(deck);

        const cardScene = document.getElementById("card-scene");
        const cardContent = document.getElementById("card-content");
        const cardElement = document.getElementById("card-element");

        cardContent.innerHTML = renderFishCardContent(fish);
        cardScene.style.visibility = "visible";
        triggerAnimation(cardElement, "drawing");
      }

      init();
    </script>
  </body>
</html>
