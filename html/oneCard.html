<!doctype html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>單張魚卡 - 除錯工具</title>
    <link rel="stylesheet" href="../css/main.css" />
    <style>
      :root {
        --render-scale: 0.5;
      }

      .info-panel {
        background: var(--color-bg-blue);
        padding: 15px 30px;
        border-radius: var(--radius-sm);
        margin-bottom: 20px;
        box-shadow: var(--shadow-card);
        z-index: 100;
      }

      .coords-display {
        color: var(--color-primary);
        font-weight: bold;
      }

      /* 除錯用虛線邊框 */
      .debug .element {
        border: 1px dashed rgba(255, 71, 87, 0.4);
      }

      /* 修正：不使用 card-wrapper 縮放，改用 scene 縮放 */
      .scene-debug {
        width: var(--card-w);
        height: var(--card-h);
        perspective: 2000px;
        transform: scale(var(--render-scale));
        transform-origin: top center;
      }

      .scene-debug .card-wrapper {
        width: 100%;
        height: 100%;
        transform: none;
      }
    </style>
  </head>
  <body class="layout-padded">
    <div class="info-panel">
      當前座標 (X, Y): <strong class="coords-display" id="coords">0, 0</strong>
    </div>

    <div class="scene-debug">
      <div class="card-wrapper">
        <div class="card" id="card">
          <div class="card-face card-front debug" id="front-face">
            <div id="poker-info" class="element poker-info anchor-center"></div>
            <div id="category" class="element category"></div>
            <div id="stars" class="element stars"></div>
            <div
              id="fish-illustration"
              class="element fish-illustration anchor-center"
            >
              <img id="fish-img" src="" alt="" />
            </div>
            <div id="fish-name" class="element fish-name anchor-center"></div>
            <div id="condition" class="element condition anchor-center"></div>
          </div>
          <div class="card-face card-back"></div>
        </div>
      </div>
    </div>

    <script type="module">
      // 測試資料
      const cardData = {
        poker: "♠7",
        category: "OYOD",
        stars: 5,
        image: "../images/ilek.jpg",
        name: "Ilek",
        condition: "捕獲條件:<br>骰子 > 五點",
      };

      function renderCard(data) {
        document.getElementById("poker-info").textContent = data.poker;
        document.getElementById("category").textContent = data.category;
        document.getElementById("stars").textContent = "★".repeat(data.stars);
        document.getElementById("fish-img").src = data.image;
        document.getElementById("fish-name").textContent = data.name;
        document.getElementById("condition").innerHTML = data.condition;
      }

      renderCard(cardData);

      // 點擊翻轉
      const card = document.getElementById("card");
      card.addEventListener("click", () => {
        card.classList.toggle("is-flipped");
      });

      // 座標偵測
      const frontFace = document.getElementById("front-face");
      const coordsDisplay = document.getElementById("coords");

      frontFace.addEventListener("mousemove", (e) => {
        const rect = frontFace.getBoundingClientRect();
        const scale = rect.width / 825;
        const x = Math.round((e.clientX - rect.left) / scale);
        const y = Math.round((e.clientY - rect.top) / scale);
        coordsDisplay.innerText = `${x}, ${y}`;
      });
    </script>
  </body>
</html>
